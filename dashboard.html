<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - OEMS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/dashboard.css">
</head>

<body>
    <!-- Dashboard Header -->
    <header class="dashboard-header">
        <div class="container">
            <div class="header-content">
                <div class="nav-brand">
                    <img src="assets/images/OEMSLogo.png" alt="OEMSLogo" style="height: 3rem;">
                </div>
                <div class="user-menu">
                    <span id="user-display-name">Loading...</span>
                    <button class="btn-secondary" id="logout-btn">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <main class="dashboard-main">
        <div class="container">
            <!-- User Profile Section -->
            <div class="profile-section fade-in">
                <div class="profile-card">
                    <div class="profile-header">
                        <div class="profile-avatar-container">
                            <div class="profile-avatar" id="profile-avatar">
                                <img id="profile-image" src="" alt="Profile" style="display: none;">
                                <div class="avatar-placeholder" id="avatar-placeholder">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="12" cy="7" r="4"></circle>
                                    </svg>
                                </div>
                                <button class="avatar-upload-btn" id="avatar-upload-btn" title="Upload profile picture">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path>
                                        <circle cx="12" cy="13" r="3"></circle>
                                    </svg>
                                </button>
                                <div class="upload-progress" id="upload-progress" style="display: none;">
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-fill"></div>
                                    </div>
                                    <span class="progress-text" id="progress-text">0%</span>
                                </div>
                                <input type="file" id="profile-image-input" accept="image/*" style="display: none;">
                            </div>
                        </div>
                        <div class="profile-info">
                            <h2 id="profile-name">Loading...</h2>
                            <p id="profile-email">user@example.com</p>
                            <div class="profile-bio" id="profile-bio-display" style="margin: 0.5rem 0; color: var(--text-muted); font-style: italic;">
                                <!-- Bio will be displayed here -->
                            </div>
                            <div class="profile-stats">
                                <div class="stat-item">
                                    <span class="stat-value" id="created-groups-count">0</span>
                                    <span class="stat-label">Created Groups</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-value" id="joined-groups-count">0</span>
                                    <span class="stat-label">Joined Groups</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-value" id="tests-taken-count">0</span>
                                    <span class="stat-label">Tests Taken</span>
                                </div>
                            </div>
                        </div>
                        <div class="profile-actions">
                            <button class="btn-primary" id="edit-profile-btn">Edit Profile</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Bar -->
            <div class="action-bar fade-in">
                <div class="action-card">
                    <h3>Join a Group</h3>
                    <form id="join-group-form" class="action-form">
                        <input type="text" id="group-code-input" class="neu-input" placeholder="Enter Group Code">
                        <button type="submit" class="btn-primary">Join</button>
                    </form>
                </div>
                <div class="action-card">
                    <h3>Take a Test by ID</h3>
                    <form id="take-test-form" class="action-form">
                        <input type="text" id="test-code-input" class="neu-input" placeholder="Enter Test Code">
                        <button type="submit" class="btn-primary">Start</button>
                    </form>
                </div>
            </div>
            
            <!-- Main Content Area -->
            <div class="content-area fade-in">
                <!-- Created Groups Section -->
                <div class="groups-section">
                    <div class="content-header">
                        <h2>My Created Groups</h2>
                        <button class="btn-primary" id="create-group-btn">+ Create New Group</button>
                    </div>
                    <div class="groups-grid" id="created-groups-grid">
                        <!-- Created groups will be dynamically inserted here -->
                    </div>
                    <p id="no-created-groups-message" class="no-groups-message" style="display: none;">
                        You haven't created any groups yet. Click "Create New Group" to get started.
                    </p>
                </div>

                <!-- Joined Groups Section -->
                <div class="groups-section">
                    <div class="content-header">
                        <h2>Joined Groups</h2>
                    </div>
                    <div class="groups-grid" id="joined-groups-grid">
                        <!-- Joined groups will be dynamically inserted here -->
                    </div>
                    <p id="no-joined-groups-message" class="no-groups-message" style="display: none;">
                        You haven't joined any groups yet. Use a group code to join an existing group.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- Edit Profile Modal -->
    <div class="modal-overlay" id="edit-profile-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Profile</h3>
                <button class="modal-close" id="close-profile-modal">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <form id="edit-profile-form" class="modal-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-first-name">First Name *</label>
                        <input type="text" id="edit-first-name" class="neu-input" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-last-name">Last Name *</label>
                        <input type="text" id="edit-last-name" class="neu-input" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="edit-bio">Bio</label>
                    <textarea id="edit-bio" class="neu-input" rows="3" placeholder="Tell us about yourself..." maxlength="500"></textarea>
                    <small class="form-hint">Max 500 characters</small>
                </div>
                <div class="form-group">
                    <label for="edit-phone">Phone Number</label>
                    <input type="tel" id="edit-phone" class="neu-input" placeholder="+1 (555) 123-4567">
                </div>
                <div class="form-group">
                    <label for="edit-location">Location</label>
                    <input type="text" id="edit-location" class="neu-input" placeholder="City, Country">
                </div>
                <div class="form-group">
                    <label for="edit-website">Website</label>
                    <input type="url" id="edit-website" class="neu-input" placeholder="https://yourwebsite.com">
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="cancel-profile-edit">Cancel</button>
                    <button type="submit" class="btn-primary" id="save-profile-btn">
                        <span class="button-text">Save Changes</span>
                        <div class="button-spinner" style="display: none;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c1.08 0 2.12.2 3.07.55"/>
                            </svg>
                        </div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="assets/js/dashboard.js" type="module"></script>
</body>

</html>